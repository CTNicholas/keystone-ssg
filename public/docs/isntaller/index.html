<html>
<head>
<!-- STATIS: Dev server script below, run without --dev variable for production -->
<script>!function(){!function e(){const o=new WebSocket("ws://localhost:8081/");let s=!1;o.onopen=(e=>{console.log("STATIS: Development server started"),s=!0});o.onmessage=(e=>{console.log("Message received:",e.data),"refresh"===e.data&&location.reload()});o.onclose=(o=>{1==s&&console.error("STATIS: Development server closed"),s=!1,setTimeout(e,2000)})}()}();</script>
</head>
<body>
<h1>docs/isntaller</h1>
<a href="/">link to home</a>
<a href="/docs/">link to docs</a>

aafweird indeedssss sssaaffssssaas

<h1> I have been imported!</h1>

<script>

if (document.readyState === 'interactive' ||
    document.readyState === 'complete') {
  run()
} else {
  document.addEventListener('DOMContentLoaded', () => {
    run()
  })
}

function run () {
  watchLinks()
  window.addEventListener('popstate', onPopState)
}

function watchLinks () {
  const links = document.querySelectorAll('a')
  for (const link of links) {
    link.addEventListener('click', linkClicked)
  }
}

function linkClicked (event) {
  if (linkAllowed(event.target)) {
    event.preventDefault()
    getPage(event.target.getAttribute('href')).then(newPage => {
      changePage(newPage, event.target.href)
    })
  }
}

function changePage (newPage, url, popstate = false) {
  document.open()
  document.write(newPage)
  document.close()
  updateHistory(url, popstate)
}

function updateHistory (url, popstate) {
  if (!popstate) {
    history.pushState(null, document.title, url)
  } 
}

function onPopState (event) {
  location.reload()
  console.log('Current href', location.href, 'popping')

  const lastUrl = location.href
  getPage(lastUrl).then(newPage => {
    changePage(newPage, lastUrl, true)
  })
}

function linkAllowed (target) {
  const sameHost = location.host === target.host
  const notSamePage =
    location.host + location.pathname + location.search !==
    target.host + target.pathname + target.search
  return sameHost && notSamePage
}

async function getPage (url) {
  try {
    return fetch(url)
      .then(response => response.text())
      .catch(() => console.log)
  } catch (err) { 
    console.log(err)
    window.location(url)
  }
}
</script></body>

</html>